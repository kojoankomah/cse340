<!-- account/register.ejs -->

<div class="register-container">
  <section class="register-card">
    <h1><%= title %></h1>

    <!-- Flash Message Display -->
    <% if (messages && messages.notice) { %>
      <div class="flash-message">
        <% messages.notice.forEach(function(msg){ %>
          <p><%= msg %></p>
        <% }) %>
      </div>
    <% } %>

    <!-- Server-side Validation Errors -->
    <% if (errors) { %>
      <ul class="notice">
        <% errors.array().forEach(error => { %>
          <li><%= error.msg %></li>
        <% }) %>
      </ul>
    <% } %>

    <form action="/account/register" method="post" class="register-form">
      <!-- First Name -->
      <label for="account_firstname">First Name</label>
      <input 
        type="text" 
        id="account_firstname" 
        name="account_firstname" 
        required 
        placeholder="First name"
        value="<%= typeof account_firstname !== 'undefined' ? account_firstname : '' %>">

      <!-- Last Name -->
      <label for="account_lastname">Last Name</label>
      <input 
        type="text" 
        id="account_lastname" 
        name="account_lastname" 
        required 
        placeholder="Last name"
        value="<%= typeof account_lastname !== 'undefined' ? account_lastname : '' %>">

      <!-- Email -->
      <label for="account_email">Email Address</label>
      <input 
        type="email" 
        id="account_email" 
        name="account_email" 
        required 
        placeholder="you@example.com"
        value="<%= typeof account_email !== 'undefined' ? account_email : '' %>">

      <!-- Password -->
      <label for="account_password">Password</label>
      <div class="password-requirements">
        Passwords must be:
        <ul>
          <li>At least 12 characters long</li>
          <li>Contain at least 1 uppercase letter</li>
          <li>Contain at least 1 lowercase letter</li>
          <li>Contain at least 1 number</li>
          <li>Contain at least 1 special character</li>
        </ul>
      </div>
      <input 
        type="password" 
        id="account_password" 
        name="account_password"
        pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$"
        required 
        placeholder="Enter a strong password">

      <button type="submit" class="btn-register">Register</button>
    </form>
  </section>
</div>

<!-- Optional Flash Fade Script -->
<script>
  setTimeout(() => {
    const flash = document.querySelector('.flash-message');
    if (flash) {
      flash.style.transition = 'opacity 0.5s ease';
      flash.style.opacity = '0';
      setTimeout(() => flash.remove(), 500);
    }
  }, 4000);
</script>
